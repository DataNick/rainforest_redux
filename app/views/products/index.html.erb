<h1>Product List</h1>
<%= link_to 'Welcome Page', root_path %> |
<%= link_to 'New Product', "/products/new" %> | 
<%= link_to 'Log In/New Session', "/sessions/new" %> |
<%= link_to 'List of Users', users_path %>

<%= form_tag products_path, method: :get, id: 'search_form' do %>
	<%= text_field_tag :search, params[:search] %>
	<%= submit_tag 'Search' %>
<% end %>

<br />

<div id="products">
	<%= render @products %>
</div>

<br />

<script type="text/javascript">
	function display_search_results() {
		if (this.readyState === 4) {
			console.log(this);
			document.getElementById('products').innerHTML = this.responseText;
		}
	}

	var form = document.getElementById('search_form');
	form.addEventListener('submit', function(event) {
		event.preventDefault();
		var searchValue = document.getElementById('search').value;

		var xhr = new XMLHttpRequest();
		xhr.onload = display_search_results;
		xhr.open('GET', '/products?search=' + searchValue, true);
		xhr.setRequestHeader("X-Requested-With", "XMLHttpRequest");
		xhr.send();
	});
	</script>
